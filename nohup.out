rake aborted!
Interrupt: 
/home/squirrel/SmartHouse/lib/tasks/wtmqtt.rake:8:in `sleep'
/home/squirrel/SmartHouse/lib/tasks/wtmqtt.rake:8:in `block (2 levels) in <main>'
Tasks: TOP => wtmqtt:subscribe
(See full trace by running task with --trace)
Subscribed
rake aborted!
OptionParser::AmbiguousOption: ambiguous option: -d


Caused by:
OptionParser::InvalidOption: invalid option: d
Did you mean?  D

(See full trace by running task with --trace)
Subscribed
New message received on topic: stat/4_Garage/POWER
>>>ON
New message received on topic: stat/4_Garage/POWER
>>>OFF
New message received on topic: stat/4_Garage/POWER
>>>ON
New message received on topic: stat/4_Garage/POWER
>>>OFF
New message received on topic: stat/4_Garage/POWER
>>>ON
New message received on topic: stat/4_Garage/POWER
>>>OFF
New message received on topic: stat/7_Front_Porch/POWER
>>>ON
New message received on topic: stat/7_Front_Porch/POWER
>>>OFF
New message received on topic: stat/7_Front_Porch/POWER
>>>ON
New message received on topic: stat/7_Front_Porch/POWER
>>>OFF
New message received on topic: stat/8_Family_Room/POWER
>>>ON
New message received on topic: stat/8_Family_Room/POWER
>>>OFF
New message received on topic: stat/3_Hall/POWER
>>>OFF
New message received on topic: stat/3_Hall/POWER
>>>ON
New message received on topic: stat/3_Hall/POWER
>>>OFF
New message received on topic: stat/3_Hall/POWER
>>>ON
New message received on topic: stat/3_Hall/POWER
>>>OFF
New message received on topic: stat/3_Hall/POWER
>>>ON
New message received on topic: stat/3_Hall/POWER
>>>OFF
New message received on topic: stat/3_Hall/POWER
>>>ON
New message received on topic: stat/3_Hall/POWER
>>>OFF
New message received on topic: stat/3_Hall/POWER
>>>ON
New message received on topic: stat/3_Hall/POWER
>>>OFF
New message received on topic: stat/7_Front_Porch/POWER
>>>ON
New message received on topic: stat/7_Front_Porch/POWER
>>>OFF
New message received on topic: stat/4_Garage/POWER
>>>ON
New message received on topic: stat/4_Garage/POWER
>>>OFF
New message received on topic: stat/4_Garage/POWER
>>>ON
New message received on topic: stat/4_Garage/POWER
>>>OFF
New message received on topic: stat/4_Garage/POWER
>>>ON
New message received on topic: stat/4_Garage/POWER
>>>OFF
New message received on topic: stat/4_Garage/POWER
>>>ON
New message received on topic: stat/4_Garage/POWER
>>>OFF
New message received on topic: stat/4_Garage/POWER
>>>ON
New message received on topic: stat/4_Garage/POWER
>>>OFF
New message received on topic: stat/4_Garage/POWER
>>>ON
New message received on topic: stat/4_Garage/POWER
>>>OFF
New message received on topic: stat/4_Garage/POWER
>>>ON
New message received on topic: stat/4_Garage/POWER
>>>OFF
New message received on topic: stat/4_Garage/POWER
>>>ON
New message received on topic: stat/4_Garage/POWER
>>>OFF
New message received on topic: stat/4_Garage/POWER
>>>ON
New message received on topic: stat/4_Garage/POWER
>>>OFF
New message received on topic: stat/4_Garage/POWER
>>>ON
New message received on topic: stat/4_Garage/POWER
>>>OFF
New message received on topic: stat/4_Garage/POWER
>>>ON
New message received on topic: stat/4_Garage/POWER
>>>OFF
New message received on topic: stat/4_Garage/POWER
>>>ON
New message received on topic: stat/4_Garage/POWER
>>>OFF
New message received on topic: stat/4_Garage/POWER
>>>ON
New message received on topic: stat/4_Garage/POWER
>>>OFF
New message received on topic: stat/4_Garage/POWER
>>>ON
New message received on topic: stat/4_Garage/POWER
>>>OFF
New message received on topic: stat/8_Family_Room/POWER
>>>ON
New message received on topic: stat/7_Front_Porch/POWER
>>>ON
New message received on topic: stat/3_Hall/POWER
>>>ON
New message received on topic: stat/4_Garage/POWER
>>>ON
New message received on topic: stat/4_Garage/POWER
>>>OFF
New message received on topic: stat/4_Garage/POWER
>>>ON
New message received on topic: stat/4_Garage/POWER
>>>OFF
New message received on topic: stat/7_Front_Porch/POWER
>>>OFF
New message received on topic: stat/7_Front_Porch/POWER
>>>ON
New message received on topic: stat/4_Garage/POWER
>>>ON
New message received on topic: stat/4_Garage/POWER
>>>OFF
New message received on topic: stat/7_Front_Porch/POWER
>>>OFF
New message received on topic: stat/7_Front_Porch/POWER
>>>ON
New message received on topic: stat/4_Garage/POWER
>>>ON
New message received on topic: stat/3_Hall/POWER
>>>OFF
New message received on topic: stat/4_Garage/POWER
>>>OFF
New message received on topic: stat/4_Garage/POWER
>>>ON
New message received on topic: stat/4_Garage/POWER
>>>OFF
New message received on topic: stat/4_Garage/POWER
>>>ON
New message received on topic: stat/4_Garage/POWER
>>>OFF
New message received on topic: stat/4_Garage/POWER
>>>ON
New message received on topic: stat/4_Garage/POWER
>>>OFF
New message received on topic: stat/3_Hall/POWER
>>>ON
New message received on topic: stat/3_Hall/POWER
>>>OFF
New message received on topic: stat/4_Garage/POWER
>>>ON
New message received on topic: stat/4_Garage/POWER
>>>OFF
New message received on topic: stat/4_Garage/POWER
>>>ON
New message received on topic: stat/4_Garage/POWER
>>>OFF
New message received on topic: stat/4_Garage/POWER
>>>ON
New message received on topic: stat/4_Garage/POWER
>>>OFF
New message received on topic: stat/4_Garage/POWER
>>>ON
New message received on topic: stat/4_Garage/POWER
>>>OFF
New message received on topic: stat/4_Garage/POWER
>>>ON
New message received on topic: stat/4_Garage/POWER
>>>OFF
New message received on topic: stat/4_Garage/POWER
>>>ON
New message received on topic: stat/4_Garage/POWER
>>>OFF
New message received on topic: stat/4_Garage/POWER
>>>ON
New message received on topic: stat/4_Garage/POWER
>>>OFF
New message received on topic: stat/4_Garage/POWER
>>>ON
New message received on topic: stat/4_Garage/POWER
>>>OFF
New message received on topic: stat/8_Family_Room/POWER
>>>OFF
New message received on topic: stat/7_Front_Porch/POWER
>>>OFF
New message received on topic: stat/7_Front_Porch/POWER
>>>ON
New message received on topic: stat/7_Front_Porch/POWER
>>>OFF
New message received on topic: stat/4_Garage/POWER
>>>ON
New message received on topic: stat/4_Garage/POWER
>>>OFF
New message received on topic: stat/4_Garage/POWER
>>>ON
New message received on topic: stat/4_Garage/POWER
>>>OFF
New message received on topic: stat/4_Garage/POWER
>>>ON
New message received on topic: stat/4_Garage/POWER
>>>OFF
New message received on topic: stat/7_Front_Porch/POWER
>>>ON
New message received on topic: stat/4_Garage/POWER
>>>ON
New message received on topic: stat/4_Garage/POWER
>>>OFF
New message received on topic: stat/4_Garage/POWER
>>>ON
New message received on topic: stat/4_Garage/POWER
>>>OFF
New message received on topic: stat/4_Garage/POWER
>>>ON
New message received on topic: stat/4_Garage/POWER
>>>OFF
New message received on topic: stat/4_Garage/POWER
>>>ON
New message received on topic: stat/4_Garage/POWER
>>>OFF
New message received on topic: stat/4_Garage/POWER
>>>ON
New message received on topic: stat/4_Garage/POWER
>>>OFF
New message received on topic: stat/4_Garage/POWER
>>>ON
New message received on topic: stat/4_Garage/POWER
>>>OFF
New message received on topic: stat/4_Garage/POWER
>>>ON
New message received on topic: stat/4_Garage/POWER
>>>OFF
New message received on topic: stat/7_Front_Porch/POWER
>>>OFF
New message received on topic: stat/7_Front_Porch/POWER
>>>ON
New message received on topic: stat/8_Family_Room/POWER
>>>ON
New message received on topic: stat/8_Family_Room/POWER
>>>OFF
New message received on topic: stat/4_Garage/POWER
>>>ON
New message received on topic: stat/4_Garage/POWER
>>>OFF
New message received on topic: stat/8_Family_Room/POWER
>>>ON
New message received on topic: stat/8_Family_Room/POWER
>>>OFF
New message received on topic: stat/3_Hall/POWER
>>>ON
New message received on topic: stat/4_Garage/POWER
>>>ON
New message received on topic: stat/8_Family_Room/POWER
>>>ON
New message received on topic: stat/8_Family_Room/POWER
>>>OFF
New message received on topic: stat/3_Hall/POWER
>>>OFF
New message received on topic: stat/4_Garage/POWER
>>>OFF
New message received on topic: stat/8_Family_Room/POWER
>>>ON
New message received on topic: stat/8_Family_Room/POWER
>>>OFF
New message received on topic: stat/8_Family_Room/POWER
>>>ON
New message received on topic: stat/8_Family_Room/POWER
>>>OFF
New message received on topic: stat/8_Family_Room/POWER
>>>ON
New message received on topic: stat/8_Family_Room/POWER
>>>OFF
New message received on topic: stat/4_Garage/POWER
>>>ON
New message received on topic: stat/8_Family_Room/POWER
>>>ON#<Thread:0x00005650cd860780 /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/paho-mqtt-1.0.12/lib/paho_mqtt/client.rb:130 run> terminated with exception (report_on_exception is true):
/home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/http-5.0.1/lib/http/timeout/null.rb:21:in `initialize': failed to connect: Connection refused - connect(2) for "localhost" port 3000 (HTTP::ConnectionError)
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/http-5.0.1/lib/http/timeout/null.rb:21:in `open'
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/http-5.0.1/lib/http/timeout/null.rb:21:in `connect'
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/http-5.0.1/lib/http/connection.rb:42:in `initialize'
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/http-5.0.1/lib/http/client.rb:72:in `new'
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/http-5.0.1/lib/http/client.rb:72:in `perform'
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/http-5.0.1/lib/http/client.rb:31:in `request'
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/http-5.0.1/lib/http/chainable.rb:75:in `request'
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/http-5.0.1/lib/http/chainable.rb:20:in `get'
	from /home/squirrel/SmartHouse/config/initializers/wtmqtt.rb:19:in `block in on_message'
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/paho-mqtt-1.0.12/lib/paho_mqtt/handler.rb:147:in `handle_publish'
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/paho-mqtt-1.0.12/lib/paho_mqtt/handler.rb:58:in `handle_packet'
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/paho-mqtt-1.0.12/lib/paho_mqtt/handler.rb:47:in `receive_packet'
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/paho-mqtt-1.0.12/lib/paho_mqtt/client.rb:169:in `block in loop_read'
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/paho-mqtt-1.0.12/lib/paho_mqtt/client.rb:168:in `times'
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/paho-mqtt-1.0.12/lib/paho_mqtt/client.rb:168:in `loop_read'
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/paho-mqtt-1.0.12/lib/paho_mqtt/client.rb:184:in `mqtt_loop'
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/paho-mqtt-1.0.12/lib/paho_mqtt/client.rb:134:in `block in daemon_mode'
/home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/http-5.0.1/lib/http/timeout/null.rb:21:in `initialize': Connection refused - connect(2) for "localhost" port 3000 (Errno::ECONNREFUSED)
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/http-5.0.1/lib/http/timeout/null.rb:21:in `open'
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/http-5.0.1/lib/http/timeout/null.rb:21:in `connect'
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/http-5.0.1/lib/http/connection.rb:42:in `initialize'
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/http-5.0.1/lib/http/client.rb:72:in `new'
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/http-5.0.1/lib/http/client.rb:72:in `perform'
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/http-5.0.1/lib/http/client.rb:31:in `request'
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/http-5.0.1/lib/http/chainable.rb:75:in `request'
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/http-5.0.1/lib/http/chainable.rb:20:in `get'
	from /home/squirrel/SmartHouse/config/initializers/wtmqtt.rb:19:in `block in on_message'
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/paho-mqtt-1.0.12/lib/paho_mqtt/handler.rb:147:in `handle_publish'
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/paho-mqtt-1.0.12/lib/paho_mqtt/handler.rb:58:in `handle_packet'
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/paho-mqtt-1.0.12/lib/paho_mqtt/handler.rb:47:in `receive_packet'
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/paho-mqtt-1.0.12/lib/paho_mqtt/client.rb:169:in `block in loop_read'
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/paho-mqtt-1.0.12/lib/paho_mqtt/client.rb:168:in `times'
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/paho-mqtt-1.0.12/lib/paho_mqtt/client.rb:168:in `loop_read'
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/paho-mqtt-1.0.12/lib/paho_mqtt/client.rb:184:in `mqtt_loop'
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/paho-mqtt-1.0.12/lib/paho_mqtt/client.rb:134:in `block in daemon_mode'
rake aborted!
HTTP::ConnectionError: failed to connect: Connection refused - connect(2) for "localhost" port 3000
/home/squirrel/SmartHouse/config/initializers/wtmqtt.rb:19:in `block in on_message'

Caused by:
Errno::ECONNREFUSED: Connection refused - connect(2) for "localhost" port 3000
/home/squirrel/SmartHouse/config/initializers/wtmqtt.rb:19:in `block in on_message'
Tasks: TOP => wtmqtt:subscribe
(See full trace by running task with --trace)

New message received on topic: stat/8_Family_Room/POWER
>>>OFF
New message received on topic: stat/8_Family_Room/POWER
>>>ON
New message received on topic: stat/8_Family_Room/POWER
>>>OFF
New message received on topic: stat/8_Family_Room/POWER
>>>ON
New message received on topic: stat/8_Family_Room/POWER
>>>OFF
New message received on topic: stat/4_Garage/POWER
>>>OFF
New message received on topic: stat/4_Garage/POWER
>>>ON
New message received on topic: stat/8_Family_Room/POWER
>>>ON
New message received on topic: stat/8_Family_Room/POWER
>>>OFF
New message received on topic: stat/4_Garage/POWER
>>>OFF
New message received on topic: stat/8_Family_Room/POWER
>>>ON
New message received on topic: stat/8_Family_Room/POWER
>>>OFF
New message received on topic: stat/8_Family_Room/POWER
>>>ON
New message received on topic: stat/8_Family_Room/POWER
>>>OFF
New message received on topic: stat/4_Garage/POWER
>>>ON
New message received on topic: stat/8_Family_Room/POWER
>>>ON
New message received on topic: stat/8_Family_Room/POWER
>>>OFF
New message received on topic: stat/4_Garage/POWER
>>>OFF
New message received on topic: stat/7_Front_Porch/POWER
>>>OFF
New message received on topic: stat/7_Front_Porch/POWER
>>>ON
New message received on topic: stat/7_Front_Porch/POWER
>>>OFF
New message received on topic: stat/7_Front_Porch/POWER
>>>ON
New message received on topic: stat/7_Front_Porch/POWER
>>>OFF
New message received on topic: stat/7_Front_Porch/POWER
>>>ON
New message received on topic: stat/7_Front_Porch/POWER
>>>OFF
New message received on topic: stat/7_Front_Porch/POWER
>>>ON
New message received on topic: stat/8_Family_Room/POWER
>>>ON
New message received on topic: stat/4_Garage/POWER
>>>ON
New message received on topic: stat/4_Garage/POWER
>>>OFF
New message received on topic: stat/8_Family_Room/POWER
>>>OFF
New message received on topic: stat/7_Front_Porch/POWER
>>>OFF
New message received on topic: stat/4_Garage/POWER
>>>ON
New message received on topic: stat/4_Garage/POWER
>>>OFF
New message received on topic: stat/4_Garage/POWER
>>>ON
New message received on topic: stat/7_Front_Porch/POWER
>>>ON
New message received on topic: stat/8_Family_Room/POWER
>>>ON
New message received on topic: stat/8_Family_Room/POWER
>>>OFF
New message received on topic: stat/7_Front_Porch/POWER
>>>OFF
New message received on topic: stat/4_Garage/POWER
>>>OFF
New message received on topic: stat/3_Hall/POWER
>>>ON
New message received on topic: stat/8_Family_Room/POWER
>>>ON
New message received on topic: stat/7_Front_Porch/POWER
>>>ON
New message received on topic: stat/8_Family_Room/POWER
>>>OFF
New message received on topic: stat/7_Front_Porch/POWER
>>>OFF
New message received on topic: stat/3_Hall/POWER
>>>OFF
New message received on topic: stat/4_Garage/POWER
>>>ON
New message received on topic: stat/4_Garage/POWER
>>>OFF
New message received on topic: stat/4_Garage/POWER
>>>ON
New message received on topic: stat/4_Garage/POWER
>>>OFF
New message received on topic: stat/7_Front_Porch/POWER
>>>ON
New message received on topic: stat/7_Front_Porch/POWER
>>>OFF
New message received on topic: stat/8_Family_Room/POWER
>>>ON
New message received on topic: stat/8_Family_Room/POWER
>>>OFF
New message received on topic: stat/3_Hall/POWER
>>>ON
New message received on topic: stat/3_Hall/POWER
>>>OFF
New message received on topic: stat/4_Garage/POWER
>>>ON
#<Thread:0x000055863352cda8 /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/paho-mqtt-1.0.12/lib/paho_mqtt/client.rb:130 run> terminated with exception (report_on_exception is true):
/home/squirrel/SmartHouse/config/initializers/wtmqtt.rb:27:in `block in on_message': undefined method `id' for nil:NilClass (NoMethodError)
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/paho-mqtt-1.0.12/lib/paho_mqtt/handler.rb:147:in `handle_publish'
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/paho-mqtt-1.0.12/lib/paho_mqtt/handler.rb:58:in `handle_packet'
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/paho-mqtt-1.0.12/lib/paho_mqtt/handler.rb:47:in `receive_packet'
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/paho-mqtt-1.0.12/lib/paho_mqtt/client.rb:169:in `block in loop_read'
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/paho-mqtt-1.0.12/lib/paho_mqtt/client.rb:168:in `times'
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/paho-mqtt-1.0.12/lib/paho_mqtt/client.rb:168:in `loop_read'
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/paho-mqtt-1.0.12/lib/paho_mqtt/client.rb:184:in `mqtt_loop'
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/paho-mqtt-1.0.12/lib/paho_mqtt/client.rb:134:in `block in daemon_mode'
rake aborted!
NoMethodError: undefined method `id' for nil:NilClass
/home/squirrel/SmartHouse/config/initializers/wtmqtt.rb:27:in `block in on_message'
Tasks: TOP => wtmqtt:subscribe
(See full trace by running task with --trace)
Subscribed
New message received on topic: stat/Switch_1_Garage/POWER
>>>ON
#<Thread:0x00007f145804df08 /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/paho-mqtt-1.0.12/lib/paho_mqtt/client.rb:130 run> terminated with exception (report_on_exception is true):
/home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/http-5.0.1/lib/http/timeout/null.rb:21:in `initialize': failed to connect: Connection refused - connect(2) for "localhost" port 3000 (HTTP::ConnectionError)
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/http-5.0.1/lib/http/timeout/null.rb:21:in `open'
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/http-5.0.1/lib/http/timeout/null.rb:21:in `connect'
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/http-5.0.1/lib/http/connection.rb:42:in `initialize'
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/http-5.0.1/lib/http/client.rb:72:in `new'
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/http-5.0.1/lib/http/client.rb:72:in `perform'
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/http-5.0.1/lib/http/client.rb:31:in `request'
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/http-5.0.1/lib/http/chainable.rb:75:in `request'
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/http-5.0.1/lib/http/chainable.rb:20:in `get'
	from /home/squirrel/SmartHouse/config/initializers/wtmqtt.rb:52:in `block in on_message'
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/paho-mqtt-1.0.12/lib/paho_mqtt/handler.rb:147:in `handle_publish'
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/paho-mqtt-1.0.12/lib/paho_mqtt/handler.rb:58:in `handle_packet'
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/paho-mqtt-1.0.12/lib/paho_mqtt/handler.rb:47:in `receive_packet'
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/paho-mqtt-1.0.12/lib/paho_mqtt/client.rb:169:in `block in loop_read'
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/paho-mqtt-1.0.12/lib/paho_mqtt/client.rb:168:in `times'
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/paho-mqtt-1.0.12/lib/paho_mqtt/client.rb:168:in `loop_read'
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/paho-mqtt-1.0.12/lib/paho_mqtt/client.rb:184:in `mqtt_loop'
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/paho-mqtt-1.0.12/lib/paho_mqtt/client.rb:134:in `block in daemon_mode'
/home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/http-5.0.1/lib/http/timeout/null.rb:21:in `initialize': Connection refused - connect(2) for "localhost" port 3000 (Errno::ECONNREFUSED)
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/http-5.0.1/lib/http/timeout/null.rb:21:in `open'
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/http-5.0.1/lib/http/timeout/null.rb:21:in `connect'
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/http-5.0.1/lib/http/connection.rb:42:in `initialize'
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/http-5.0.1/lib/http/client.rb:72:in `new'
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/http-5.0.1/lib/http/client.rb:72:in `perform'
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/http-5.0.1/lib/http/client.rb:31:in `request'
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/http-5.0.1/lib/http/chainable.rb:75:in `request'
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/http-5.0.1/lib/http/chainable.rb:20:in `get'
	from /home/squirrel/SmartHouse/config/initializers/wtmqtt.rb:52:in `block in on_message'
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/paho-mqtt-1.0.12/lib/paho_mqtt/handler.rb:147:in `handle_publish'
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/paho-mqtt-1.0.12/lib/paho_mqtt/handler.rb:58:in `handle_packet'
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/paho-mqtt-1.0.12/lib/paho_mqtt/handler.rb:47:in `receive_packet'
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/paho-mqtt-1.0.12/lib/paho_mqtt/client.rb:169:in `block in loop_read'
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/paho-mqtt-1.0.12/lib/paho_mqtt/client.rb:168:in `times'
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/paho-mqtt-1.0.12/lib/paho_mqtt/client.rb:168:in `loop_read'
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/paho-mqtt-1.0.12/lib/paho_mqtt/client.rb:184:in `mqtt_loop'
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/paho-mqtt-1.0.12/lib/paho_mqtt/client.rb:134:in `block in daemon_mode'
rake aborted!
HTTP::ConnectionError: failed to connect: Connection refused - connect(2) for "localhost" port 3000
/home/squirrel/SmartHouse/config/initializers/wtmqtt.rb:52:in `block in on_message'

Caused by:
Errno::ECONNREFUSED: Connection refused - connect(2) for "localhost" port 3000
/home/squirrel/SmartHouse/config/initializers/wtmqtt.rb:52:in `block in on_message'
Tasks: TOP => wtmqtt:subscribe
(See full trace by running task with --trace)
Subscribed
New message received on topic: stat/Switch_1_Garage/POWER
>>>OFF
#<Thread:0x000055f753079c98 /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/paho-mqtt-1.0.12/lib/paho_mqtt/client.rb:130 run> terminated with exception (report_on_exception is true):
/home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/activemodel-5.2.4.4/lib/active_model/attribute_methods.rb:430:in `method_missing': undefined method `device_id' for #<SlaveSwitch:0x000055f752002b30> (NoMethodError)
	from /home/squirrel/SmartHouse/config/initializers/wtmqtt.rb:48:in `block in on_message'
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/paho-mqtt-1.0.12/lib/paho_mqtt/handler.rb:147:in `handle_publish'
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/paho-mqtt-1.0.12/lib/paho_mqtt/handler.rb:58:in `handle_packet'
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/paho-mqtt-1.0.12/lib/paho_mqtt/handler.rb:47:in `receive_packet'
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/paho-mqtt-1.0.12/lib/paho_mqtt/client.rb:169:in `block in loop_read'
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/paho-mqtt-1.0.12/lib/paho_mqtt/client.rb:168:in `times'
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/paho-mqtt-1.0.12/lib/paho_mqtt/client.rb:168:in `loop_read'
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/paho-mqtt-1.0.12/lib/paho_mqtt/client.rb:184:in `mqtt_loop'
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/paho-mqtt-1.0.12/lib/paho_mqtt/client.rb:134:in `block in daemon_mode'
rake aborted!
NoMethodError: undefined method `device_id' for #<SlaveSwitch:0x000055f752002b30>
/home/squirrel/SmartHouse/config/initializers/wtmqtt.rb:48:in `block in on_message'
Tasks: TOP => wtmqtt:subscribe
(See full trace by running task with --trace)
Subscribed
New message received on topic: stat/SlaveSwitch_1_Lamp/POWER
>>>OFF
#<Thread:0x000055a9875f6a28 /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/paho-mqtt-1.0.12/lib/paho_mqtt/client.rb:130 run> terminated with exception (report_on_exception is true):
/home/squirrel/SmartHouse/config/initializers/wtmqtt.rb:49:in `block in on_message': undefined method `toggle_light' for #<WTMQTT:0x000055a9876064c8> (NoMethodError)
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/paho-mqtt-1.0.12/lib/paho_mqtt/handler.rb:147:in `handle_publish'
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/paho-mqtt-1.0.12/lib/paho_mqtt/handler.rb:58:in `handle_packet'
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/paho-mqtt-1.0.12/lib/paho_mqtt/handler.rb:47:in `receive_packet'
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/paho-mqtt-1.0.12/lib/paho_mqtt/client.rb:169:in `block in loop_read'
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/paho-mqtt-1.0.12/lib/paho_mqtt/client.rb:168:in `times'
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/paho-mqtt-1.0.12/lib/paho_mqtt/client.rb:168:in `loop_read'
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/paho-mqtt-1.0.12/lib/paho_mqtt/client.rb:184:in `mqtt_loop'
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/paho-mqtt-1.0.12/lib/paho_mqtt/client.rb:134:in `block in daemon_mode'
rake aborted!
NoMethodError: undefined method `toggle_light' for #<WTMQTT:0x000055a9876064c8>
/home/squirrel/SmartHouse/config/initializers/wtmqtt.rb:49:in `block in on_message'
Tasks: TOP => wtmqtt:subscribe
(See full trace by running task with --trace)
Subscribed
New message received on topic: stat/SlaveSwitch_1_Lamp/POWER
>>>ON
#<Thread:0x00005594419f96f8 /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/paho-mqtt-1.0.12/lib/paho_mqtt/client.rb:130 run> terminated with exception (report_on_exception is true):
/home/squirrel/SmartHouse/config/initializers/wtmqtt.rb:44:in `block in on_message': undefined local variable or method `payload' for #<WTMQTT:0x0000559441a05ed0> (NameError)
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/paho-mqtt-1.0.12/lib/paho_mqtt/handler.rb:147:in `handle_publish'
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/paho-mqtt-1.0.12/lib/paho_mqtt/handler.rb:58:in `handle_packet'
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/paho-mqtt-1.0.12/lib/paho_mqtt/handler.rb:47:in `receive_packet'
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/paho-mqtt-1.0.12/lib/paho_mqtt/client.rb:169:in `block in loop_read'
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/paho-mqtt-1.0.12/lib/paho_mqtt/client.rb:168:in `times'
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/paho-mqtt-1.0.12/lib/paho_mqtt/client.rb:168:in `loop_read'
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/paho-mqtt-1.0.12/lib/paho_mqtt/client.rb:184:in `mqtt_loop'
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/paho-mqtt-1.0.12/lib/paho_mqtt/client.rb:134:in `block in daemon_mode'
rake aborted!
NameError: undefined local variable or method `payload' for #<WTMQTT:0x0000559441a05ed0>
/home/squirrel/SmartHouse/config/initializers/wtmqtt.rb:44:in `block in on_message'
Tasks: TOP => wtmqtt:subscribe
(See full trace by running task with --trace)
Subscribed
New message received on topic: stat/Switch_1_Garage/POWER
>>>ON
#<Thread:0x000055e9a189a2e8 /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/paho-mqtt-1.0.12/lib/paho_mqtt/client.rb:130 run> terminated with exception (report_on_exception is true):
/home/squirrel/SmartHouse/config/initializers/wtmqtt.rb:44:in `block in on_message': undefined local variable or method `payload' for #<WTMQTT:0x000055e9a18ae388> (NameError)
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/paho-mqtt-1.0.12/lib/paho_mqtt/handler.rb:147:in `handle_publish'
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/paho-mqtt-1.0.12/lib/paho_mqtt/handler.rb:58:in `handle_packet'
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/paho-mqtt-1.0.12/lib/paho_mqtt/handler.rb:47:in `receive_packet'
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/paho-mqtt-1.0.12/lib/paho_mqtt/client.rb:169:in `block in loop_read'
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/paho-mqtt-1.0.12/lib/paho_mqtt/client.rb:168:in `times'
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/paho-mqtt-1.0.12/lib/paho_mqtt/client.rb:168:in `loop_read'
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/paho-mqtt-1.0.12/lib/paho_mqtt/client.rb:184:in `mqtt_loop'
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/paho-mqtt-1.0.12/lib/paho_mqtt/client.rb:134:in `block in daemon_mode'
rake aborted!
NameError: undefined local variable or method `payload' for #<WTMQTT:0x000055e9a18ae388>
/home/squirrel/SmartHouse/config/initializers/wtmqtt.rb:44:in `block in on_message'
Tasks: TOP => wtmqtt:subscribe
(See full trace by running task with --trace)
Subscribed
New message received on topic: stat/Switch_1_Garage/POWER
>>>ON
#<Thread:0x00005563b980a468 /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/paho-mqtt-1.0.12/lib/paho_mqtt/client.rb:130 run> terminated with exception (report_on_exception is true):
/home/squirrel/SmartHouse/config/initializers/wtmqtt.rb:44:in `block in on_message': undefined method `8_action' for #<WTMQTT:0x00005563b9816bc8> (NoMethodError)
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/paho-mqtt-1.0.12/lib/paho_mqtt/handler.rb:147:in `handle_publish'
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/paho-mqtt-1.0.12/lib/paho_mqtt/handler.rb:58:in `handle_packet'
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/paho-mqtt-1.0.12/lib/paho_mqtt/handler.rb:47:in `receive_packet'
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/paho-mqtt-1.0.12/lib/paho_mqtt/client.rb:169:in `block in loop_read'
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/paho-mqtt-1.0.12/lib/paho_mqtt/client.rb:168:in `times'
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/paho-mqtt-1.0.12/lib/paho_mqtt/client.rb:168:in `loop_read'
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/paho-mqtt-1.0.12/lib/paho_mqtt/client.rb:184:in `mqtt_loop'
	from /home/squirrel/.rbenv/versions/2.7.0/lib/ruby/gems/2.7.0/gems/paho-mqtt-1.0.12/lib/paho_mqtt/client.rb:134:in `block in daemon_mode'
rake aborted!
NoMethodError: undefined method `8_action' for #<WTMQTT:0x00005563b9816bc8>
/home/squirrel/SmartHouse/config/initializers/wtmqtt.rb:44:in `block in on_message'
Tasks: TOP => wtmqtt:subscribe
(See full trace by running task with --trace)
Subscribed
New message received on topic: stat/Switch_1_Garage/POWER
>>>ON
New message received on topic: stat/Switch_1_Garage/POWER
>>>OFF
New message received on topic: stat/Switch_2_Lamp/POWER
>>>ON
New message received on topic: stat/Switch_2_Lamp/POWER
>>>OFF
New message received on topic: stat/SlaveSwitch_1_Lamp/POWER
>>>ON
Message Acknowledged
New message received on topic: stat/Switch_2_Lamp/POWER
>>>ON
New message received on topic: stat/SlaveSwitch_1_Lamp/POWER
>>>OFF
Message Acknowledged
New message received on topic: stat/Switch_2_Lamp/POWER
>>>OFF
New message received on topic: stat/Switch_2_Lamp/POWER
>>>ON
New message received on topic: stat/Switch_2_Lamp/POWER
>>>OFF
New message received on topic: stat/Switch_1_Garage/POWER
>>>ON
New message received on topic: stat/Switch_1_Garage/POWER
>>>OFF
New message received on topic: stat/SlaveSwitch_1_Lamp/POWER
>>>ON
Message Acknowledged
New message received on topic: stat/SlaveSwitch_1_Lamp/POWER
>>>OFF
Message Acknowledged
New message received on topic: stat/Switch_2_Lamp/POWER
>>>ON
New message received on topic: stat/Switch_2_Lamp/POWER
>>>OFF
New message received on topic: stat/SlaveSwitch_1_Lamp/POWER
>>>ON
New message received on topic: stat/SlaveSwitch_1_Lamp/POWER
>>>OFF
Message Acknowledged
Message Acknowledged
New message received on topic: stat/Switch_2_Lamp/POWER
>>>ON
New message received on topic: stat/Switch_2_Lamp/POWER
>>>OFF
New message received on topic: stat/SlaveSwitch_1_Lamp/POWER
>>>ON
Message Acknowledged
New message received on topic: stat/Switch_2_Lamp/POWER
>>>ON
New message received on topic: stat/SlaveSwitch_1_Lamp/POWER
>>>OFF
Message Acknowledged
New message received on topic: stat/Switch_2_Lamp/POWER
>>>OFF
New message received on topic: stat/SlaveSwitch_1_Lamp/POWER
>>>ON
Message Acknowledged
New message received on topic: stat/Switch_2_Lamp/POWER
>>>ON
New message received on topic: stat/SlaveSwitch_1_Lamp/POWER
>>>OFF
Message Acknowledged
New message received on topic: stat/Switch_2_Lamp/POWER
>>>OFF
New message received on topic: stat/SlaveSwitch_1_Lamp/POWER
>>>ON
Message Acknowledged
New message received on topic: stat/SlaveSwitch_1_Lamp/POWER
>>>OFF
Message Acknowledged
New message received on topic: stat/Switch_2_Lamp/POWER
>>>ON
New message received on topic: stat/Switch_2_Lamp/POWER
>>>OFF
New message received on topic: stat/SlaveSwitch_1_Lamp/POWER
>>>ON
Message Acknowledged
New message received on topic: stat/Switch_2_Lamp/POWER
>>>ON
New message received on topic: stat/SlaveSwitch_1_Lamp/POWER
>>>OFF
Message Acknowledged
New message received on topic: stat/Switch_2_Lamp/POWER
>>>OFF
New message received on topic: stat/SlaveSwitch_1_Lamp/POWER
>>>ON
Message Acknowledged
New message received on topic: stat/Switch_2_Lamp/POWER
>>>ON
New message received on topic: stat/SlaveSwitch_1_Lamp/POWER
>>>OFF
Message Acknowledged
New message received on topic: stat/Switch_2_Lamp/POWER
>>>OFF
New message received on topic: stat/SlaveSwitch_1_Lamp/POWER
>>>ON
Message Acknowledged
New message received on topic: stat/Switch_2_Lamp/POWER
>>>ON
New message received on topic: stat/SlaveSwitch_1_Lamp/POWER
>>>OFF
Message Acknowledged
New message received on topic: stat/Switch_2_Lamp/POWER
>>>OFF
New message received on topic: stat/SlaveSwitch_1_Lamp/POWER
>>>ON
Message Acknowledged
New message received on topic: stat/Switch_2_Lamp/POWER
>>>ON
New message received on topic: stat/SlaveSwitch_1_Lamp/POWER
>>>OFF
Message Acknowledged
New message received on topic: stat/Switch_2_Lamp/POWER
>>>OFF
New message received on topic: stat/SlaveSwitch_1_Lamp/POWER
>>>ON
Message Acknowledged
New message received on topic: stat/Switch_2_Lamp/POWER
>>>ON
New message received on topic: stat/SlaveSwitch_1_Lamp/POWER
>>>OFF
Message Acknowledged
New message received on topic: stat/Switch_2_Lamp/POWER
>>>OFF
New message received on topic: stat/SlaveSwitch_1_Lamp/POWER
>>>ON
Message Acknowledged
New message received on topic: stat/Switch_2_Lamp/POWER
>>>ON
New message received on topic: stat/8_Family_Room/POWER
>>>OFF
